# Prompt Completo para Implementa√ß√£o do ENEM.AI

## üéØ Contexto do Projeto

Voc√™ √© um desenvolvedor s√™nior especializado em tecnologia educacional. Precisa implementar o **ENEM.AI**, um tutor inteligente para prepara√ß√£o em Matem√°tica e Ci√™ncias da Natureza do ENEM. Este √© um projeto de TCC com foco em impacto social e valida√ß√£o cient√≠fica.

## üìã Stack Tecnol√≥gico Definido

- **Frontend:** React.js + Next.js (dashboard estudantil)
- **Orquestra√ß√£o:** n8n (workflows educacionais)
- **IA:** OpenAI GPT-4 + fine-tuning com quest√µes ENEM
- **Banco:** PostgreSQL (quest√µes categorizadas + progresso)
- **Analytics:** Sistema pr√≥prio de tracking de performance
- **UI:** Design inspirado em apps de vestibular (Me Salva, Descomplica)

## üéØ Objetivo Principal

Criar um MVP funcional que:
1. **Diagnostique** lacunas de conhecimento do estudante
2. **Gere** quest√µes personalizadas estilo ENEM via IA
3. **Avalie** respostas usando sistema TRI simplificado
4. **Adapte** dificuldade baseada na performance
5. **Trackee** progresso para valida√ß√£o cient√≠fica

## üìä Funcionalidades Core (MVP)

### 1. Sistema de Diagn√≥stico Inicial
- Simulado de 20 quest√µes (15 matem√°tica + 5 ci√™ncias)
- Categoriza√ß√£o por compet√™ncias ENEM
- C√°lculo de n√≠vel inicial (B√°sico/Intermedi√°rio/Avan√ßado)

### 2. Gerador de Quest√µes IA
- Prompts espec√≠ficos para criar quest√µes estilo ENEM
- Contextualizadas com gr√°ficos/tabelas/situa√ß√µes reais
- 3 n√≠veis de dificuldade por compet√™ncia
- Valida√ß√£o autom√°tica de qualidade

### 3. Sistema TRI Simplificado
- Algoritmo de pontua√ß√£o baseado em acertos/erros
- Feedback educativo sobre cada resposta
- C√°lculo de "nota estimada ENEM"

### 4. Dashboard de Progresso
- Visualiza√ß√£o de compet√™ncias (radar chart)
- Hist√≥rico de performance
- Metas e cronograma at√© o ENEM

## üèóÔ∏è Arquitetura T√©cnica

```
Frontend (Next.js) ‚ÜîÔ∏è API Routes ‚ÜîÔ∏è n8n Webhooks ‚ÜîÔ∏è PostgreSQL
                                     ‚ÜïÔ∏è
                                 OpenAI API
```

## üîß Implementa√ß√£o Detalhada

### ETAPA 1: Setup Base do Projeto
```bash
# Criar projeto Next.js
npx create-next-app@latest enem-ai --typescript --tailwind --app-dir

# Depend√™ncias essenciais
npm install @prisma/client prisma postgresql recharts lucide-react
npm install @radix-ui/react-dialog @radix-ui/react-select
npm install openai axios
```

### ETAPA 2: Banco de Dados (PostgreSQL)
```sql
-- Schema principal
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  email VARCHAR(100) UNIQUE NOT NULL,
  target_score INTEGER DEFAULT 600,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE competencias (
  id SERIAL PRIMARY KEY,
  area VARCHAR(50), -- 'matematica' ou 'ciencias'
  codigo VARCHAR(10), -- 'M1', 'M2', 'CN1', etc.
  titulo TEXT NOT NULL,
  descricao TEXT
);

CREATE TABLE questoes (
  id SERIAL PRIMARY KEY,
  competencia_id INTEGER REFERENCES competencias(id),
  enunciado TEXT NOT NULL,
  alternativas JSONB NOT NULL, -- {a: "texto", b: "texto", ...}
  gabarito CHAR(1) NOT NULL,
  explicacao TEXT NOT NULL,
  dificuldade INTEGER DEFAULT 2, -- 1=f√°cil, 2=m√©dio, 3=dif√≠cil
  contexto TEXT, -- situa√ß√£o-problema
  created_by VARCHAR(20) DEFAULT 'ai' -- 'ai' ou 'manual'
);

CREATE TABLE user_respostas (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  questao_id INTEGER REFERENCES questoes(id),
  resposta CHAR(1) NOT NULL,
  correto BOOLEAN NOT NULL,
  tempo_segundos INTEGER,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE user_progress (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  competencia_id INTEGER REFERENCES competencias(id),
  nivel_atual INTEGER DEFAULT 1, -- 1=b√°sico, 2=intermedi√°rio, 3=avan√ßado
  acertos INTEGER DEFAULT 0,
  tentativas INTEGER DEFAULT 0,
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### ETAPA 3: n8n Workflows

#### Workflow 1: Diagn√≥stico Inicial
```json
{
  "nodes": [
    {
      "name": "Webhook - Iniciar Diagn√≥stico",
      "type": "webhook",
      "webhookId": "diagnostico-inicial"
    },
    {
      "name": "Buscar Quest√µes Base",
      "type": "postgres",
      "query": "SELECT * FROM questoes WHERE dificuldade = 2 ORDER BY RANDOM() LIMIT 20"
    },
    {
      "name": "Preparar Simulado",
      "type": "code",
      "code": "// Formatar quest√µes para o frontend"
    },
    {
      "name": "Resposta ao Frontend",
      "type": "webhook-response"
    }
  ]
}
```

#### Workflow 2: Gerar Quest√£o via IA
```json
{
  "nodes": [
    {
      "name": "Webhook - Solicitar Quest√£o",
      "type": "webhook",
      "parameters": {
        "httpMethod": "POST",
        "path": "gerar-questao"
      }
    },
    {
      "name": "Buscar Perfil Usu√°rio",
      "type": "postgres",
      "query": "SELECT * FROM user_progress WHERE user_id = {{$json.user_id}}"
    },
    {
      "name": "Chamar OpenAI",
      "type": "openai",
      "prompt": "PROMPT_GERAR_QUESTAO_ENEM"
    },
    {
      "name": "Validar e Salvar",
      "type": "code"
    },
    {
      "name": "Retornar Quest√£o",
      "type": "webhook-response"
    }
  ]
}
```

#### Workflow 3: Avaliar Resposta
```json
{
  "nodes": [
    {
      "name": "Webhook - Receber Resposta",
      "type": "webhook"
    },
    {
      "name": "Verificar Gabarito",
      "type": "postgres"
    },
    {
      "name": "Calcular TRI Simplificado",
      "type": "code"
    },
    {
      "name": "Atualizar Progresso",
      "type": "postgres"
    },
    {
      "name": "Gerar Feedback",
      "type": "openai"
    }
  ]
}
```

### ETAPA 4: Prompts OpenAI Otimizados

#### Prompt para Gera√ß√£o de Quest√µes
```
CONTEXTO: Voc√™ √© especialista em criar quest√µes de MATEM√ÅTICA para o ENEM.

COMPET√äNCIA: {{competencia}}
N√çVEL: {{nivel}} (1=b√°sico, 2=m√©dio, 3=avan√ßado)
PERFIL DO ALUNO: {{perfil_aluno}}

INSTRU√á√ïES OBRIGAT√ìRIAS:
1. Crie UMA quest√£o contextualizada (situa√ß√£o real, gr√°fico, tabela)
2. Estilo ENEM: interpreta√ß√£o + c√°lculo + racioc√≠nio l√≥gico
3. 5 alternativas plaus√≠veis (A, B, C, D, E)
4. Inclua distratores inteligentes (erros comuns)

FORMATO DE RESPOSTA (JSON):
{
  "enunciado": "Texto completo da quest√£o com contexto",
  "alternativas": {
    "a": "alternativa A",
    "b": "alternativa B",
    "c": "alternativa C",
    "d": "alternativa D",
    "e": "alternativa E"
  },
  "gabarito": "c",
  "explicacao": "Resolu√ß√£o passo a passo",
  "competencia_foco": "c√≥digo da compet√™ncia",
  "dificuldade_estimada": 2,
  "contexto_aplicado": "breve descri√ß√£o da situa√ß√£o real usada"
}

EXEMPLO DE QUALIDADE ESPERADA:
- Situa√ß√£o: consumo de energia el√©trica dom√©stica
- Conceito: fun√ß√£o linear/proporcionalidade
- C√°lculo: interpreta√ß√£o de gr√°fico + regra de tr√™s
- Pegadinha: unidades de medida diferentes

CRIE A QUEST√ÉO AGORA:
```

#### Prompt para Feedback Educativo
```
CONTEXTO: Dar feedback pedag√≥gico sobre resposta de quest√£o ENEM.

DADOS:
- Quest√£o: {{enunciado}}
- Resposta correta: {{gabarito}}
- Resposta do aluno: {{resposta_aluno}}
- Explica√ß√£o: {{explicacao_oficial}}

SE ACERTOU:
- Parabenize de forma motivadora
- Destaque o conceito aplicado corretamente
- Sugira pr√≥ximo t√≥pico relacionado

SE ERROU:
- Explique o erro sem julgamento
- Mostre o caminho correto passo a passo
- Sugira revis√£o do conceito b√°sico
- Seja emp√°tico e encorajador

TOME CUIDADO:
- Use linguagem jovem mas respeitosa
- Seja espec√≠fico sobre o erro
- Conecte com aplica√ß√µes pr√°ticas
- Motive a continuar estudando

RESPONDA EM PORTUGU√äS BRASILEIRO:
```

### ETAPA 5: Frontend React

#### Componente Principal - Dashboard
```jsx
// app/dashboard/page.tsx
'use client';
import { useState, useEffect } from 'react';
import { CompetenciasRadar } from '@/components/CompetenciasRadar';
import { ProgressoSemanal } from '@/components/ProgressoSemanal';
import { ProximaQuestao } from '@/components/ProximaQuestao';

export default function Dashboard() {
  const [userProgress, setUserProgress] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchUserProgress();
  }, []);

  const fetchUserProgress = async () => {
    const response = await fetch('/api/user/progress');
    const data = await response.json();
    setUserProgress(data);
    setLoading(false);
  };

  if (loading) return <div>Carregando seu progresso...</div>;

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50">
      <div className="container mx-auto p-6">
        <header className="mb-8">
          <h1 className="text-3xl font-bold text-gray-800">
            Seu Progresso no ENEM üéØ
          </h1>
          <p className="text-gray-600">
            Faltam {userProgress.diasParaEnem} dias para o ENEM
          </p>
        </header>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <CompetenciasRadar data={userProgress.competencias} />
          <ProgressoSemanal data={userProgress.semanal} />
          <ProximaQuestao userId={userProgress.userId} />
        </div>
      </div>
    </div>
  );
}
```

#### Componente - Quest√£o ENEM
```jsx
// components/QuestaoEnem.tsx
'use client';
import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader } from '@/components/ui/card';

interface QuestaoProps {
  questao: {
    id: number;
    enunciado: string;
    alternativas: Record<string, string>;
    competencia: string;
  };
  onResponder: (resposta: string) => void;
}

export function QuestaoEnem({ questao, onResponder }: QuestaoProps) {
  const [respostaSelecionada, setRespostaSelecionada] = useState('');
  const [tempo, setTempo] = useState(0);

  useEffect(() => {
    const timer = setInterval(() => setTempo(t => t + 1), 1000);
    return () => clearInterval(timer);
  }, []);

  const handleSubmit = () => {
    onResponder(respostaSelecionada);
  };

  return (
    <Card className="max-w-4xl mx-auto">
      <CardHeader>
        <div className="flex justify-between items-center">
          <span className="text-sm font-medium text-blue-600">
            {questao.competencia}
          </span>
          <span className="text-sm text-gray-500">
            ‚è±Ô∏è {Math.floor(tempo / 60)}:{String(tempo % 60).padStart(2, '0')}
          </span>
        </div>
      </CardHeader>
      
      <CardContent className="space-y-6">
        <div className="prose prose-sm">
          <p className="text-gray-800 leading-relaxed">
            {questao.enunciado}
          </p>
        </div>

        <div className="space-y-3">
          {Object.entries(questao.alternativas).map(([letra, texto]) => (
            <label key={letra} className="flex items-start space-x-3 cursor-pointer">
              <input
                type="radio"
                name="resposta"
                value={letra}
                checked={respostaSelecionada === letra}
                onChange={(e) => setRespostaSelecionada(e.target.value)}
                className="mt-1"
              />
              <span className="text-sm">
                <strong>{letra.toUpperCase()})</strong> {texto}
              </span>
            </label>
          ))}
        </div>

        <Button 
          onClick={handleSubmit}
          disabled={!respostaSelecionada}
          className="w-full"
        >
          Confirmar Resposta
        </Button>
      </CardContent>
    </Card>
  );
}
```

### ETAPA 6: APIs Next.js

#### API - Buscar Nova Quest√£o
```typescript
// app/api/questao/nova/route.ts
import { NextRequest, NextResponse } from 'next/server';

export async function POST(req: NextRequest) {
  try {
    const { userId } = await req.json();
    
    // Chamar workflow n8n
    const n8nResponse = await fetch(`${process.env.N8N_URL}/webhook/gerar-questao`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ user_id: userId })
    });
    
    const questao = await n8nResponse.json();
    
    return NextResponse.json(questao);
  } catch (error) {
    return NextResponse.json({ error: 'Erro ao gerar quest√£o' }, { status: 500 });
  }
}
```

#### API - Avaliar Resposta
```typescript
// app/api/questao/avaliar/route.ts
export async function POST(req: NextRequest) {
  try {
    const { userId, questaoId, resposta, tempo } = await req.json();
    
    // Chamar workflow n8n de avalia√ß√£o
    const avaliacao = await fetch(`${process.env.N8N_URL}/webhook/avaliar-resposta`, {
      method: 'POST',
      body: JSON.stringify({
        user_id: userId,
        questao_id: questaoId,
        resposta: resposta,
        tempo_segundos: tempo
      })
    });
    
    const resultado = await avaliacao.json();
    
    return NextResponse.json({
      correto: resultado.correto,
      feedback: resultado.feedback,
      explicacao: resultado.explicacao,
      novoNivel: resultado.novo_nivel
    });
  } catch (error) {
    return NextResponse.json({ error: 'Erro na avalia√ß√£o' }, { status: 500 });
  }
}
```

### ETAPA 7: Analytics de Performance

#### Tracker de M√©tricas
```typescript
// lib/analytics.ts
interface EventData {
  userId: number;
  action: string;
  questaoId?: number;
  competencia?: string;
  correto?: boolean;
  tempo?: number;
  dificuldade?: number;
}

export class ENEMAnalytics {
  static async track(event: EventData) {
    try {
      await fetch('/api/analytics', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          ...event,
          timestamp: new Date().toISOString(),
          session: window.sessionStorage.getItem('session_id')
        })
      });
    } catch (error) {
      console.error('Analytics error:', error);
    }
  }
}

// Uso nos componentes:
// ENEMAnalytics.track({ userId: 1, action: 'questao_respondida', questaoId: 123, correto: true, tempo: 90 });
```

## üöÄ Ordem de Implementa√ß√£o Recomendada

### Fase 1: Funda√ß√£o
- Setup Next.js + TypeScript + Tailwind
- Configura√ß√£o PostgreSQL + schema
- Setup n8n + webhooks b√°sicos
- Seed inicial do banco

### Fase 2: Backend Core
- Workflows n8n principais
- Integra√ß√£o OpenAI + prompts
- APIs Next.js essenciais
- Sistema TRI simplificado

### Fase 3: Frontend MVP
- Dashboard estudantil
- Componente de quest√£o
- Sistema de feedback
- Interface de progresso

### Fase 4: Refinamento
- Testes com quest√µes reais
- Otimiza√ß√£o de prompts
- Analytics e m√©tricas
- Deploy e valida√ß√£o

## ‚ö†Ô∏è Pontos Cr√≠ticos de Aten√ß√£o

1. **Cr√©ditos OpenAI Limitados**
   - Use cache agressivo para quest√µes geradas
   - Implemente fallback com quest√µes pr√©-cadastradas
   - Monitore uso de tokens

2. **Qualidade das Quest√µes IA**
   - Valide SEMPRE o JSON de resposta
   - Tenha banco de backup manual
   - Implemente sistema de rating das quest√µes

3. **Performance do Sistema TRI**
   - Use aproxima√ß√µes matem√°ticas simples
   - Cache c√°lculos complexos
   - Otimize queries do PostgreSQL

4. **Valida√ß√£o para TCC**
   - Implemente tracking detalhado desde o in√≠cio
   - Colete dados anonimizados
   - Prepare m√©tricas para an√°lise estat√≠stica

## üéØ Resultado Esperado

Ao final da implementa√ß√£o, voc√™ ter√°:
- ‚úÖ MVP funcional do ENEM.AI
- ‚úÖ Sistema de quest√µes personalizadas via IA
- ‚úÖ Dashboard de progresso estudantil
- ‚úÖ Dados para valida√ß√£o cient√≠fica
- ‚úÖ Base s√≥lida para o TCC

**Este prompt foi otimizado para maximizar o resultado com m√≠nimo de itera√ß√µes. Siga a sequ√™ncia exata e ter√° um MVP robusto em 4 semanas!**